from unittest.mock import MagicMock

from hydromt_fiat import FIATModel
from hydromt_fiat.components import VulnerabilityComponent
from hydromt_fiat.components.vulnerability import VulnerabilityData


def test_vulnerability_component_empty(
    mock_model: MagicMock,
):
    # Setup the component
    component = VulnerabilityComponent(model=mock_model)

    # Assert the content
    assert component._filename == "vulnerability/curves.csv"
    assert component.data.curves.empty
    assert isinstance(component.data, VulnerabilityData)


def test_vulnerability_component_setup(model: FIATModel):
    # Setup the component
    component = VulnerabilityComponent(model=model)

    # Assert it's empty
    assert component.data.curves.empty

    # Setup the vulnerability
    component.setup(
        vulnerability_fname="vulnerability_curves",
        vulnerability_linking_fname="vulnerability_curves_linking",
        continent="europe",
    )

    assert not component.data.curves.empty
    assert not component.data.identifiers.empty
